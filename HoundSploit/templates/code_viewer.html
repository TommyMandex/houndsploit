{% extends 'base.html' %}
{% block scripts_and_css %}
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify/loader/run_prettify.js"></script>
    <link href="/static/css/code_viewer.css" rel="stylesheet">
{% endblock %}
{% block code_viewer %}
    <div class="vulnerability_info">
        <table id="vulnerability-info-table" name="vulnerability-info-table" class="vulnerability_info">
            <tr>
                <th>Description:</th>
                <td>{{ vulnerability_description }}</td>
            </tr>
            <tr>
                <th>Author:</th>
                <td>{{ vulnerability_author }}</td>
            </tr>
            <tr>
                <th>File:</th>
                <td>{{ vulnerability_file }}</td>
            </tr>
            <tr>
                <th>Date:</th>
                <td>{{ vulnerability_date }}</td>
            </tr>
            <tr>
                <th>Type:</th>
                <td>{{ vulnerability_type }}</td>
            </tr>
            <tr>
                <th>Platform:</th>
                <td>{{ vulnerability_platform }}</td>
            </tr>
            {% if vulnerability_port %}
                <tr>
                    <th>Port:</th>
                    <td>{{ vulnerability_port }}</td>
                </tr>
            {% endif %}
        </table>
        <a href="{{ file_path }}" download="{{ file_name }}"><button>Download</button></a>
    </div>
    <div class="code-container">
        <pre class="prettyprint linenums:1">{{ vulnerability_code }}</pre>
    </div>
{% endblock %}